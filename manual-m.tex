\documentclass[11pt]{article}

\usepackage{ifpdf}
\usepackage{booktabs}
\usepackage{array}
\usepackage{paralist}
\usepackage{subfigure}
\usepackage[pdftex]{graphicx}
\usepackage{epstopdf}
\usepackage[cmex10]{amsmath}
\interdisplaylinepenalty=2500
\usepackage{geometry}
\geometry{letterpaper}
\usepackage{fancyhdr}
\pagestyle{fancy}
\renewcommand{\headrulewidth}{0pt}
\lhead{}\chead{}\rhead{}
\lfoot{}\cfoot{\thepage}\rfoot{}

\usepackage{amsfonts}
\usepackage{amstext}
\usepackage{booktabs}
\usepackage{threeparttable}
\usepackage{longtable}
\usepackage{listings}
\usepackage[font=normalsize]{caption}
\usepackage{textcomp}
\usepackage[usenames]{color}
\usepackage{soul}
\usepackage{fancyvrb}
\usepackage{relsize}
\usepackage[noadjust]{cite}
\usepackage{xr-hyper}
\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}
\usepackage[colorlinks=true,linkcolor=black,urlcolor=blue,hyperfootnotes=false,backref=section,citecolor=LimeGreen]{hyperref}
\usepackage{upquote}
\usepackage[title,titletoc]{appendix}

\usepackage[nottoc,notlof,notlot]{tocbibind}
%\renewcommand{\FancyVerbFormatLine}[1]{\makebox[2mm][l]{}#1}
%\DefineVerbatimEnvironment%
%  {Code}{Verbatim}
%  {fontsize=\relsize{-1.5},
%  samepage=true,
%  frame=single}

\renewcommand{\FancyVerbFormatLine}[1]{\makebox[2mm][l]{}#1}
\DefineVerbatimEnvironment%
  {Notice}{Verbatim}
  {fontsize=\relsize{-1.5},
  samepage=true,
  xleftmargin=15mm,
  framesep=5mm,
  frame=single}

\newcommand{\covemda}{CoVEMDA}
\newcommand{\covemdagithuburl}{https://github.com/tamu-engineering-research/COVID-EMDA}
\newcommand{\matlab}{\textsc{MATLAB}}

\definecolor{BackgroundColor}{HTML}{e7f2fa}
\definecolor{SepColor}{HTML}{6ab0de}
\definecolor{DarkGreen}{rgb}{0.0,0.4,0.0}

\lstnewenvironment{Code}
    {\lstset{
        language=matlab,
        frame=shadowbox, 
        frameshape={RYRYNYYYY}{yny}{yny}{RYRYNYYYY},
        basicstyle=\ttfamily,
        commentstyle=\color{DarkGreen},
        stringstyle=\color{purple},
        keywordstyle=\bfseries\color{blue},
        backgroundcolor=\color{BackgroundColor}%
        %rulesepcolor=\color{SepColor}%
        }}
    {}

        
\def\sectionautorefname{Chapter}
\def\subsectionautorefname{Section}
\def\subsubsectionautorefname{Section}
\newcommand{\secref}[1]{\autoref{#1} \nameref{#1}}

\numberwithin{equation}{section}
\numberwithin{table}{section}
\renewcommand{\thetable}{\thesection\mbox{-}\arabic{table}}
\numberwithin{figure}{section}
\renewcommand{\thefigure}{\thesection\mbox{-}\arabic{figure}}



%%% title setting
\title{User's Manual for\\\textbf{CoVEMDA Toolbox}}
\author{}
\date{\today}



%%% BEGIN DOCUMENT
\begin{document}
\makeatletter
    \begin{titlepage}
        \begin{center}
            \includegraphics[width=.7\textwidth]{figures/covid_emda_logo.JPG}%
            \vskip 0.5ex%
            {\huge \@title \par}

        \end{center}
    \end{titlepage}
\makeatother
\thispagestyle{empty}
\newpage
\tableofcontents
\thispagestyle{empty}


%-------------------------------
\newpage
\setcounter{page}{1}
\section*{Website}
\addcontentsline{toc}{section}{Website}

\url{https://github.com/tamu-engineering-research/COVID-EMDA}

\begin{center}
	\noindent\includegraphics[width=0.5\textwidth]{figures/covid_emda_logo.JPG}
\end{center}



%-------------------------------
\newpage
\section{Introduction} \label{sec:intro}

\subsection{Background}

With high contagiousness and long incubation period, the COVID-19 pandemic has not only endangered the human life and health, but also seriously affected the economy worldwide. Considering that the operation of power system has been greatly threatened by the pandemic, to effectively respond to the effects, Tsinghua University collaborated with Texas A\&M Engineering University developed the COVID-EMDA+ Dataset.

It was believed that the analysis on the cross-domain data might provided great assistance and support for relevant research concerning the policy development on public health emergencies. On the other hand, it has been increasingly urgent for researchers to explore the actual influences of human interventions like Demand Response (DR) on large-scale power system. From this aspect, changes in residential electricity consumption during the COVID-19 constructed a unique case-study on the correlations among various factors in complex power system.

Therefore, a more comprehensive MATLAB toolbox named CoVEMDA was motivated for analysis. Based on COVID-EMDA+ Dataset, CoVEMDA is designed for functionalities including \textbf{Data Visualization}, \textbf{Baseline Estimation} and \textbf{Regression Analysis}, as well as other useful supplementary functions.
\subsection{Features}
\begin{itemize}
    \item[$\bullet$] Data Source. CoVEMDA toolbox is initially developed to supprt COVID-EMDA+ Dataset. COVID-EMDA+ cross-domain dataset involves electricity market data, public health data, weather data and mobility data for \textbf{all the existing U.S. electricity marketplaces} and some typical cities\footnote{Which refers to Los Angeles, Boston, New York City, Philadelphia, Chicago, Kansas City, Houston} in these markets. The data released is under strict quality control. To be note, the external data is acceptable for CoVEMDA\footnote{This feature should be useful for users with poor connections with official COVID-EMDA+ on GitHub Repository}.
    \item[$\bullet$] Data visualization. Visualization of almost all the data fields are implemented in the form of one-click (or one-line, to be specific) function, despite the variation of date range.
    \item[$\bullet$] Baseline estimation. Conventional methods for baseline estimation including date and week alignment are introduced in CoVEMDA, while an \textbf{Ensemble Backcast Model} could provide better estimation with more valuable information.
    \item[$\bullet$] Regression analysis. Cross-domain factors to be concerned, a Restricted Vector Auto Regression model is implemented in the toolbox, tailored for both the power system operators and the policy makers.
\end{itemize}


\subsection{Support Team}

Together with COVID-EMDA dataset, this project is a collaboration of our group members under the supervision of Prof. Haiwang Zhong at Tsinghua University and Prof. Le Xie at Texas A\&M University. The support team keeps processing, correcting and updating the data every day. Yet the final responsibility for CoVEMDA Toolbox should be assign to the group leading by Prof. Zhong at Tsinghua University.

\begin{figure}[!ht]
    \centering
    \includegraphics[width=.8\textwidth]{figures/contributor-extend-20210408.png}
    \caption{Support Team}
\end{figure}

Please also check our \href{https://gridx.engr.tamu.edu/?page_id=30}{Group Website} for the detailed biography of each group member.

\subsection{Suggested Citation}
Publications originated from the employment of data files in COVID-EMDA+, or the supplementary toolbox, are requested to cite the following paper explicitly and properly: 

\begin{quotation}\footnotesize
G. Ruan, D. Wu, X. Zheng, H. Zhong, C. Kang, M. A. Dahleh, S. Sivaranjani, and L. Xie, ``A Cross-Domain Approach to Analyzing the Short-Run Impact of COVID-19 on the U.S. Electricity Sector,'' Joule, 2020. (Accepted)
\end{quotation}

This paper conducts a comprehensive introduction of this data hub and further analysis results for electricity demand across the U.S. Its full text is available at: \href{https://arxiv.org/abs/2005.06631}{arXiv} and \href{http://www.enerarxiv.org/page/thesis.html?id=1840}{EnerarXiv}.

Other research studies of our group are recommended to be cited as:

\begin{quotation}\footnotesize
G. Ruan, J. Wu, H. Zhong, Q. Xia, and L. Xie, ``Quantitative Assessment of U.S. Bulk Power Systems and Market Operations during the COVID-19 Pandemic,'' 2020. (Submitted to Applied Energy)
\end{quotation}

This paper substantiates the pandemic's impacts from the perspectives of power system security, electric power generation, electric power demand and electricity prices. Its full text is available at: \href{http://www.enerarxiv.org/page/thesis.html?id=2196}{EnerarXiv}.

\begin{quotation}\footnotesize
H. Zhong, Z. Tan, Y. He, L. Xie, and C. Kang, ``Implications of COVID-19 for the Electricity Industry: A Comprehensive Review'', CSEE Journal of Power and Energy Systems, 2020.
\end{quotation}

This paper provides a review of the global impacts that COVID-19 has caused on the electricity sector. Its full text is available at: \href{https://ieeexplore.ieee.org/abstract/document/9160443}{JPES}.

\subsection{License}
The code of \covemda~is licensed under the \textbf{MIT License}, the full text of which can be found at the top level of distribution or \url{https://github.com/tamu-engineering-research/COVID-EMDA/blob/master/LICENSE} and reads as follows.
\begin{Notice}
Copyright (c) 2020 Guangchun Ruan

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
\end{Notice}






%-------------------------------
\newpage
\section{Getting Started} \label{sec:start}

\subsection{System Requirements}
To use \covemda~Toolbox you will need: MATLAB\textsuperscript{\tiny \textregistered} version 9.8 (R2020a). 

\small\emph{
\begin{enumerate}[NOTE 1]
    \item Despite the fact that \textbf{GNU Octave} can also tackle \textsf{.m} files, several functions like \textsf{isdatetime}  have not been implemented in \textbf{GNU Octave} (even the latest 6.1.0).
    \item For those who want long-term data support, \textbf{Git}\footnote{``Git is a free and open-source distributed version control system.'' It can guarantee you the easy access to the latest released data in multiple platforms. Git is available on its \href{https://git-scm.com/}{official website}, where both command-line version and gui version are provided.}/\textbf{GitHub Desktop}\footnote{``GitHub Desktop extends and simplifies your Git and GitHub workflow using a visual interface.'' Only systems of macOS and Windows are supported. The software is accessible at \url{https://desktop.github.com/}, while docs are available at \url{https://docs.github.com/en/desktop}} are needed for your latter convenience.
\end{enumerate}    
}

As for the hardware requirements, please refer to the System Requirements of MATLAB according to the specific version\footnote{\url{https://www.mathworks.com/support/requirements/previous-releases.html}}.

\subsection{Getting Data and Toolbox}
Our distribution containing COVID-EMDA data hub and toolbox can be obtained from the GitHub repository. You can either download the whole package of a specific distribution, or subscribe the daily-updated data via cloning the repository to your local folder.

\subsubsection{Download Specific Distribution}
    To get a specific distribution, please download the compressed zip-file of GitHub repository, as seen in Figure~\ref{fig:githubwebsite}.
    \begin{itemize}
        \item Go to \href{\covemdagithuburl}{\covemda~GitHub repository} by browser.
        \item Click the green \textbf{Code} button.
        \item Click the \textbf{Download ZIP} button.
        \item Uncompress the zip file to certain directory.
        \begin{figure}[htbp]
            \centering
            \includegraphics[width=.8\textwidth]{figures/github_website_step_1.png}
            \caption{Download from GitHub Website}
            \label{fig:githubwebsite}
        \end{figure}
    \end{itemize}
\textbf{Note}: Use this option to obtain updated data or new features of toolbox, if you are unfamiliar with or have no access to \textbf{Git}/\textbf{GitHub Desktop}.\footnote{But it would not be a bad idea to give \textbf{Git}/\textbf{GitHub Desktop} a try.}


\subsubsection{Clone GitHub Repository}
    \textbf{Git} (Either command-line or gui version is OK.) or \textbf{GitHub Desktop} is required to clone GitHub repository.
    \begin{itemize}
        \item \textbf{Git} required. Open the \textbf{Git Bash} at certain file folder (the one you want the software to be placed in) and type the following command:

\verb!git clone https://github.com/tamu-engineering-research/COVID-EMDA.git!

        \item Or if you are unfamiliar with \textbf{Git Bash}, open \textbf{Git GUI} and 
        \begin{enumerate}
            \item Click the \textbf{Clone Existing Repository} button.
            
            \begin{figure}[htbp]
                \centering
                \includegraphics[width=.8\textwidth]{figures/git_gui_step_1.png}
                \caption{Git GUI: Click \textbf{Clone Existing Repository}}
            \end{figure}

            \item Type in ``https://github.com/tamu-engineering-research/COVID-EMDA.git'' in Source Location.
            \item Choose the local folder of your project, e.g., \verb!My Project! under disk G.
            
            \begin{figure}[htbp]
                \centering
                \includegraphics[width=.8\textwidth]{figures/git_gui_step_2.png}
                \caption{Git GUI: Filling two blanks}
            \end{figure}

            \item Click the \textbf{Clone} button and wait.
    
        \end{enumerate}

        \item \textbf{Github Desktop} required. 
        \begin{enumerate}
            \item Click \textbf{Clone repository...} under the \textbf{File} menu bar. 
            \begin{figure}[htbp]
                \centering
                \includegraphics[width=.8\textwidth]{figures/github_desktop_step_1.png}
                \caption{GitHub Desktop: \textbf{Clone repository} in the menu bar}
            \end{figure}
            \item Choose \textbf{URL} and input \verb!username/repository! as follows: 
            
            \verb!tamu-engineering-research/COVID-EMDA!

            \begin{figure}[htbp]
                \centering
                \includegraphics[width=.8\textwidth]{figures/github_desktop_step_2.png}
                \caption{GitHub Desktop: Choose source and local path}
            \end{figure}

            \item Choose your local repository path and click \textbf{Clone}.
        \end{enumerate}
    \end{itemize} 

\clearpage
\subsection{Illustrative Examples}

\begin{itemize}
  \item Backcast: 
  \item Regression Analysis: 
\end{itemize}



%----------------------------------------
\newpage
\section{Data Hub} \label{sec:datahub}
The data hub, COVID-EMDA+ (Coronavirus Disease - Electricity Market Data Aggregation+), is specifically designed to track the potential impacts of COVID-19 on the existing U.S. electricity markets. Many different data sources are merged and harmonized here in order to enable further interdisciplinary researches. 

\textbf{Note}: Historical data dating back to 2017 are included as time-series benchmarks.

\subsection{Data Category}
Five major components are included in the data hub: 
\begin{itemize}
	\item U.S. electricity market data\footnote{Source: \href{http://oasis.caiso.com/mrioasis/logon.do}{CAISO}, \href{https://www.misoenergy.org/markets-and-operations/real-time--market-data/market-reports/}{MISO}, \href{https://www.iso-ne.com/markets-operations/iso-express}{ISO-NE}, \href{https://www.nyiso.com/energy-market-operational-data}{NYISO}, \href{https://dataminer2.pjm.com/list}{PJM}, \href{https://marketplace.spp.org/groups/operational_data}{SPP}, \href{http://www.ercot.com/}{ERCOT}, \href{https://www.eia.gov/beta/electricity/gridmonitor/dashboard/electric_overview/US48/US48}{EIA}, \href{http://www.energyonline.com/}{EnergyOnline}.}. This part includes the generation mix, metered load profiles, day-ahead locational marginal prices data, as well as day-ahead load forecasting, congestion price, forced outage and renewable curtailment data.
	\item Public health data\footnote{Source: \href{https://github.com/CSSEGISandData/COVID-19}{John Hopkins CSSE}.}. This part includes the COVID-19 confirmed cases, deaths data, infection rate and fatal rate.
	\item Weather data\footnote{Source: \href{https://mesonet.agron.iastate.edu/request/download.phtml}{Iowa State Univ IEM}, \href{https://www.nws.noaa.gov/ost/asostech.html}{NOAA}.}. This part includes temperature, relative humidity, wind speed and dew point data. Typical weather stations are selected according to their geological locations and data quality.
	\item Mobile device location data. This part includes social-distancing data and patterns of visits to Point of Interests (POIs). These data are derived by aggregating and processing the real-time GPS location of cellphone users by Census Block Group.\footnote{To obtain the access to the original data, please visit \href{https://docs.safegraph.com/docs}{Mobility Data From SafeGraph} and apply for SafeGraph's permission (totally free).}
	\item Statellite images. Night Time Light (NTL)	Satellite data, to be specific. This part includes the raw satellite image taken at night time in each area.\footnote{Source: \href{https://ladsweb.modaps.eosdis.nasa.gov/missions-and-measurements/products/VNP46A1/}{NTL Images from NASA}.}
\end{itemize}
For some categories, multipl data sources are carefully gathered to ensure accurary.
\subsection{Data Structure}
This data hub mainly contains five components: source data, released data, supplementary resources, parser codes, and quick start tutorials. We navigate this data hub as shown in Figure~\ref{fig:filenavi}.
\begin{figure}[htbp]
	\centering
	\includegraphics[width=.8\textwidth]{figures/folder-structure-0725.png}
	\caption{File Navigation.}
	\label{fig:filenavi}
\end{figure}

All the data source files are archived in folder \textit{data\_source}, while the cleaned, processed data are stored in folder \textit{data\_release}. Daily updates containing the latest data would be properly classified by location. The file name convention of COVID-EMDA+ is: \textbf{MARKET\_AREA\_CATEGORY.csv}, e.g. \textit{nyiso\_nyc\_load.csv} is a dataset of load profile in New York City from 2017 to present.
\footnote{Some quick start for the data itself is also accessible in folder \textit{startup} and \textit{supplementary}.}

\subsection{Field Description}
As mentioned, \textit{data\_release} folder contains all the cleaned and processed data. The file name follows the convention of \textbf{MARKET\_AREA\_CATEGORY.csv}. 
All the files are organized in a wide csv table. Here are some tips for you to better utilize the data.
\subsubsection{Electricity Market Data}
\begin{itemize}
	\item Field \textit{date}: list all the date from 2017 to present. Format: \textit{YYYY-mm-dd}
	\item Field \textit{fuel}: only in generation mix dataset, represent the different fuel source used by generators. Possible values: \textit{coal, gas, oil, nuclear, hydro, wind, solar, export, other.} Different definitions in different electricity markets are harmonized.
	\item Field \textit{kind}: only in weather dataset, represent the type of measurement that is recorded in each corresponding row. Possible value: \textit{dwpc (dew point temperature), relh (relative humidity), sped (wind speed), tmpc (temperature)}.
	\item Field \textit{HH:MM}: represent the hourly time slot. For example, column ``08:00'' records the data of period 8AM to 9AM.
\end{itemize}
\subsubsection{COVID-19 Data}
\begin{itemize}
	\item Field \textit{date}: list all the date from Jan. 23, 2020 to present. Format: \textit{YYYY-mm-dd}
	\item Field \textit{accum\_confirm}: accmulated confirmed case number recorded at each date.
	\item Field \textit{new\_confirm}: newly confirmed case number at each date.
	\item Field \textit{infect\_rate}: infection ratio calculated at each date.
	\item Field \textit{accum\_death}: accmulated confirmed death number recorded at each date.
	\item Field \textit{new\_death}: newly confirmed death number at each date.
	\item Field \textit{fatal\_rate}: fatal rate calculated at each date.
\end{itemize}
\subsubsection{Visit Patterns to Point of Interests}
\begin{itemize}
	\item Field \textit{date}: list all the date from Dec.30, 2019 to present. Format: \textit{YYYY-mm-dd}
	\item Field \textit{Restaurant\_Recreaction}: daily total number of visits to Restaurant and Recreaction places. 
	\item Field \textit{Grocery\_Pharmacy}: daily total number of visits to Grocery and Pharmacy places.
	\item Field \textit{Retail}: daily total number of visits to Retail places. 
\end{itemize}
\subsubsection{Social Distancing}
\begin{itemize}
	\item Field \textit{date}: list all the date from Jan. 1, 2020 to present. Format: \textit{YYYY-mm-dd}
	\item Field \textit{completely\_home\_device\_count\_percentage}: percentage of devices that stay at home 24 hours out of all devices.
	\item Field \textit{median\_home\_dwell\_time\_percentage}: median proportion of home dwell time in one day.
	\item Field \textit{part\_time\_work\_behavior\_devices\_percentage}: percentage of devices that go to workplaces for 3 to 6 hours out of all devices.
	\item Field \textit{full\_time\_work\_behavior\_devices\_percentage}: percentage of devices that go to workplaces for more than 6 hours out of all devices.
	\item Field \textit{completely\_home\_device\_count}: count of devices that stay at home 24 hours.
	\item Field \textit{device\_count}: total count of devices.
	\item Field \textit{part\_time\_work\_behavior\_devices\_count}: count of devices that go to workplaces for 3 to 6 hours.
	\item Field \textit{full\_time\_work\_behavior\_devices\_count}: count of devices that go to workplaces for more than 6 hours.
\end{itemize}
\subsection{Quality Control}
\begin{figure}[htbp]
	\centering
	\includegraphics[width=.8\textwidth]{figures/data-quality-control.png}
	\caption{Details of Data Quality Control. Data quality control mainly includes two aspects: outlier detection and missing data recovery. Backup data and historical trend are used to achieve both functions. For those that cannot be handled, we record them in the data quality report as shown in the Github as well.}
	\label{fig:dataqualitycontrol}
\end{figure}
To provide reliable and easy-to-use datasets, a series of data checking and cleaning procedures are implemented, including cross validation	among different data sources. 
In details, (as shown in Figure~\ref{fig:dataqualitycontrol})
\begin{itemize}
	\item Single missing data (most frequent) are filled by linear interpolation. For consecutive missing data (for example, consecutive missing dates, which are very rare), data from the EIA or EnergyOnline are carefully supplemented.
	\item Outlier data samples are automatically detected when they are beyond 5 times or below 20\% of the associated daily average value. Exceptions such as price spikes and negative prices in LMP data are carefully handled.
	\item Duplicate data are dropped, only the first occurrence of each data sample is kept.
\end{itemize}
It is recommended to check the following table to get some knowledge of data released before you use the datasets.


% Please add the following required packages to your document preamble:
% \usepackage[normalem]{ulem}
% \useunder{\uline}{\ul}{}
\begin{table}[htbp]
	\scriptsize
	\begin{tabular}{llllp{0.3\textwidth}}
	\toprule
	\multicolumn{1}{l}{\textbf{Dataset Name}} & \multicolumn{1}{l}{\textbf{Market}} & \multicolumn{1}{l}{\textbf{Area}} & \multicolumn{1}{l}{\textbf{Category}} & \multicolumn{1}{l}{\textbf{Missing Dates}}                                                                                   \\
	\midrule
	caiso\_rto\_genmix.csv                    & CAISO                               & RTO Level                         & Generation Mix                        & Sep 23 - Oct 3, 2019                                                                                                         \\
	caiso\_rto\_lmp.csv                       & CAISO                               & RTO Level                         & Day-Ahead LMP                         & Jan 1 - Jan 18, 2017; Oct 5, Oct 9, 2020                                                                                     \\
	caiso\_la\_load.csv                       & Near CAISO                          & Los Angeles                       & Hourly Load                           & Nov 5, 2017; Jan 11 - 12, Jun 29 - 30, Jul 1 - 9, Sep 27, Nov 4, 2018; Mar 10, Nov 3, 2019; Mar 8, Nov 1, 2020; Mar 14, 2021 \\
	caiso\_la\_weather                        & CAISO                               & Los Angeles                       & Weather                               & Apr 7 - 8, 2021                                                                                                              \\
	ercot\_rto\_load.csv                      & \textbf{ERCOT}                      & \textbf{RTO Level}                & \textbf{Hourly Load}                  & Dec 13, 2020                                                                                                                 \\
	ercot\_houston\_load.csv                  & ERCOT                               & Houston City                      & Hourly Load                           & Dec 13, 2020                                                                                                                 \\
	ercot\_houston\_weather.csv               & ERCOT                               & Houston City                      & Weather                               & Feb 15 - 16, 2020                                                                                                            \\
	isone\_rto\_genmix.csv                    & ISO-NE                              & RTO Level                         & Generation Mix                        & Apr 30, 2018; Jun 21, Oct 30-31, Dec 06, 2020                                                                                \\
	isone\_rto\_load.csv                      & ISO-NE                              & RTO Level                         & Hourly Load                           & Dec 17, 2020                                                                                                                 \\
	pjm\_rto\_genmix.csv                      & PJM                                 & RTO Level                         & Generation Mix                        & Mar 29 - Apr 2, 2017                                                                                                         \\
	spp\_rto\_genmix.csv                      & SPP                                 & RTO Level                         & Generation Mix                        & Mar 29, 2019                                                                                                                 \\
	spp\_kck\_weather.csv                     & SPP                                 & Kansas City                       & Weather                               & Sep 22 - 23                \\                                                                                                 
	\bottomrule
	\end{tabular}
	\end{table}









%--------------------------------------------
\newpage
\section{Visualization} \label{sec:visual}

\subsection{Generation Mix}

In this section, we provide two typical tools to display the generation data of U.S. electricity markets. After the COVID-19 outbreak, the total generation as well as generation share of each market in U.S. varied. In order to analyse this change, we may observe the generation data in scale of time or of generation fuels. This may offer a new approach for researchers to find out the structure change of U.S. power grid brought by COVID-19.

In \covemda{}, two typical tools regarding different scales are provided for generation analysis: \verb!plot_generation_mix! and \verb!plot_renewable_share!. Both of them obtain relevant data from file \verb!<market_name>_rto_genmix.csv! in the data hub.


\subsubsection{plot generation mix}

This function plots the generation mix of a market within specified date range. Like \verb!area!, it returns the area objects of the curve for further modification.

\begin{Code}
  ar = plot_generation_mix(market,Name,Value)
\end{Code}

This function is based on \matlab{} function \verb!area!.

By default, the function plots the generation mix of the specified market from 2017-01-01 to 2020-07-15, with month resampling.

\begin{Code}
  >> plot_generation_mix('spp');
\end{Code}

\begin{figure}
  \centering
  \noindent\includegraphics[width=0.8\textwidth]{figures/plot_generation_mix_example1.jpg}
  \caption{Generation Mix of SPP} \label{fig:vis_1}
\end{figure}

And the result is displayed in Figure~\ref{fig:vis_1}. Different color blocks demonstrate different fuel kinds as shown in legends. The area of each block shows the electric generation of each kind of fuel. In this figure, we may see that the main generation structure change is caused by the quantity of wind power generation.
 Additional optional input arguments can be used to set date range and resampling options. Under this circumstance, the arguments should be in the form of name-value pairs. Valid parameter names are listed in Table~\ref{tab:plot_gene_mix_option}. See the help for \verb!plot_generation_mix! for details.
 \newpage

\begin{table}[!ht]
\centering
\begin{threeparttable}
\caption{Plot Generation Mix Option}
\label{tab:plot_gene_mix_option}
\footnotesize
\begin{tabular}{lp{.3\textwidth}p{0.5\textwidth}}
\toprule
Name & Type & Description \\
\midrule
DateRange & \begin{tabular}[t]{l}
datetime array\\
string array\\
cell array of character vectors\\
\end{tabular} & Range of time. \\
& & \begin{tabular}[t]{l @{ -- } l}
Default & \verb!{'2017-01-01','2020-07-15'}!.\\
Example & \verb!{'2017-01-01','2020-07-15'}!\\
& \verb!["2020-02-01","2020-04-30"]!\\
\end{tabular}\\
\midrule
ResampleBin & \begin{tabular}[t]{l}
string\\
character vectors\\
\end{tabular} & Binning scheme for resampling. \tnote{\dag}\\
& & \begin{tabular}[t]{l @{ -- } l}
Default & \verb!'month'!.\\
\end{tabular}\\
\midrule
ColorMap & \begin{tabular}[t]{l}
table\\
structure array\\
string array\\
cell array of character vectors\\
\end{tabular} & Colors of all the areas in the plot. \tnote{\ddag}\\
& & \begin{tabular}[t]{l}
Default --\\
\verb!["coal","gas","oil","nuclear","hydro",!\\
\verb!"wind","solar","other","import";!\\
\verb!"#a67a6d","#f69850","#b35711","#3f9b98",!\\
\verb!"#a0d8f1","#73c698","#ffbd4a",!\\
\verb!"#b4b4b4","white"]!\\
\end{tabular}\\
\midrule
Others & & Modifications of the area objects.\tnote{\ddag}\\
\bottomrule
\end{tabular}
\begin{tablenotes}
    \scriptsize
    \item [\dag] {See also \verb!groupsummary!.}
    \item [\ddag] {See also \verb!Area Properties!.}
\end{tablenotes}
\end{threeparttable}
\end{table}

\subsubsection{plot renewable share}

This function plots the renewable share curve of a market within specified date range. Like \verb!plot!, it returns the line objects of the curve for further modification.

\begin{Code}
  p = plot_renewable_share(market,Name,Value)
\end{Code}

This function is based on \matlab{} function \verb!plot!.

By default, the function plots the renewable share of the specified market from 2017-01-01 to 2020-07-15, with no resampling.Additional optional input arguments can be used to set date range, resampling options and resampling methods. Under this circumstance, the arguments should be in the form of name-value pairs. Valid parameter names are listed in Table~\ref{tab:plot_renewable_share_option}. See the help for \verb!plot_renewable_share! for details.
\clearpage

\begin{table}[!ht]
\centering
\begin{threeparttable}
\caption{Plot Renewable Share Options}
\label{tab:plot_renewable_share_option}
\footnotesize
\begin{tabular}{lp{.3\textwidth}p{0.5\textwidth}}
\toprule
Name & Type & Description \\
\midrule
DateRange & \begin{tabular}[t]{l}
datetime array\\
string array\\
cell array of character vectors\\
\end{tabular} & Range of time. \\
& & \begin{tabular}[t]{l @{ -- } l}
Default & \verb!{'2017-01-01','2020-07-15'}!.\\
Example & \verb!{'2017-01-01','2020-07-15'}!\\
& \verb!["2020-02-01","2020-04-30"]!\\
\end{tabular}\\
\midrule
ResampleBin & \begin{tabular}[t]{l}
string\\
character vectors\\
\end{tabular} & Binning scheme for resampling. \tnote{\dag}\\
& & \begin{tabular}[t]{l @{ -- } l}
Default & \verb!'none'!.\\
\end{tabular}\\
\midrule
      ResampleMethod & \begin{tabular}[t]{l}
        string            \\
        character vectors \\
      \end{tabular} & Computation method for resampling. \tnote{\dag}        \\
                  &                            & \begin{tabular}[t]{l @{ -- } l}
        Default & \verb!'mean'!. \\
      \end{tabular}                         \\
      \midrule
Others & & Modifications of the line objects.\tnote{\ddag}\\
\bottomrule
\end{tabular}
\begin{tablenotes}
    \scriptsize
    \item [\dag] {See also \verb!groupsummary!.}
    \item [\ddag] {See also \verb!Plot Properties!.}
\end{tablenotes}
\end{threeparttable}
\end{table}









\subsection{Demand Profiles}

Electric power demand is a significant aspect of power system analysis. After the COVID-19 outbreak, the features of demand profiles across all U.S. electricity markets have experienced several changes, which offer the researchers an important perspective to analyze the relationship between the pandemic, electricity demand patterns and power system operation.

In \covemda{}, two typical tools regarding different time scales are provided for demand analysis: \verb!plot_demand! and \verb!plot_daily_demand_profile!. Both of them obtain relevant data from file \verb!<market_name>_rto_load.csv! in the data hub.

\subsubsection{plot demand}

This function plots the demand curve of a market within specified date range. Like \verb!plot!, it returns the line object of the curve for further modification.

\begin{Code}
  p = plot_demand(market, varargin);
\end{Code}

This function is based on \matlab{} function \verb!plot!.

By default, the function plots the demand curve of the specified market from 2017-01-01 to 2020-07-15, with no resampling. Additional optional input arguments can be used to set date range and resampling options. Under this circumstance, the arguments should be in the form of name-value pairs. Valid parameter names are listed in Table~\ref{tab:plot_demand_opt}. See the help for \verb!plot_demand! for details.

\begin{table}[!ht]
  \centering
  \begin{threeparttable}
    \caption{Plot Demand Options}
    \label{tab:plot_demand_opt}
    \footnotesize
    \begin{tabular}{lp{.3\textwidth}p{0.5\textwidth}}
      \toprule
      Name        & Type                       & Description                                        \\
      \midrule
      DateRange   & \begin{tabular}[t]{l}
        datetime array                  \\
        string array                    \\
        cell array of character vectors \\
      \end{tabular} & Range of time.                                     \\
                  &                            & \begin{tabular}[t]{l @{ -- } l}
        Default & \verb!{'2017-01-01','2020-07-15'}!. \\
        Example & \verb!{'2017-01-01','2020-07-15'}!  \\
                & \verb!["2020-02-01","2020-04-30"]!  \\
      \end{tabular}                         \\
      \midrule
      ResampleBin & \begin{tabular}[t]{l}
        string            \\
        character vectors \\
      \end{tabular} & Binning scheme for resampling. \tnote{\dag}        \\
                  &                            & \begin{tabular}[t]{l @{ -- } l}
        Default & \verb!'none'!. \\
      \end{tabular}                         \\
      \midrule
      ResampleMethod & \begin{tabular}[t]{l}
        string            \\
        character vectors \\
      \end{tabular} & Computation method for resampling. \tnote{\dag}        \\
                  &                            & \begin{tabular}[t]{l @{ -- } l}
        Default & \verb!'mean'!. \\
      \end{tabular}                         \\
      \midrule
      Others      &                            & Modifications of the line object.\tnote{\ddag}    \\
      \bottomrule
    \end{tabular}
    \begin{tablenotes}
      \scriptsize
      \item [\dag]  {See also \verb!groupsummary!.}
      \item [\ddag] {See also \verb!Line Properties!.}
    \end{tablenotes}
  \end{threeparttable}
\end{table}





\subsubsection{plot daily demand curve}

This function plots the daily demand curve of a market with specified quantiles. It returns all the objects in the plot for further modification. If there are odd quantiles, the central one is displayed as a line object. Otherwise all of them are displayed as area objects.

\begin{Code}
  ar = plot_daily_demand_curve(market, varargin);
\end{Code}

This function is based on \matlab{} function \verb!area! and \verb!plot!.

By default, the function plots the daily demand curve of the specified market from 2017-01-01 to 2020-07-15 with the five quantiles representing its variation: \verb![0.05, 0.25, 0.5, 0.75, 0.95]!. For instance, use the default settings:

\begin{Code}
  >> plot_daily_demand_curve('nyiso');
\end{Code}

\begin{figure}
  \centering
  \noindent\includegraphics[width=0.8\textwidth]{figures/visualization_plot_daily_demand_curve.jpg}
  \caption{Daily Demand Curve of NYISO} \label{fig:vis_1}
\end{figure}

And the result is displayed in Figure~\ref{fig:vis_1}. In this plot, five edges of color blocks represent the five quantiles, \verb![0.05, 0.25, 0.5, 0.75, 0.95]! successively. As there are odd quantiles, the \verb!0.5! quantile is displayed as the central line. The outer light blue area represents the variation of \verb!0.05~0.95!, and the inner less-light blue area represents \verb!0.25~0.75!, to better illustrate the variation of electricity demand in the date range.

Additional optional input arguments can be used to set date range, quantiles and plot options. Under this circumstance, the arguments should be in the form of name-value pairs. Valid parameter names are listed in Table~\ref{tab:plot_dai_demand_opt}. See the help for \verb!plot_daily_demand_curve! for details.
\clearpage
\begin{table}[!ht]
  \centering
  \begin{threeparttable}
    \caption{Plot Daily Demand Curve Options}
    \label{tab:plot_dai_demand_opt}
    \footnotesize
    \begin{tabular}{lp{.3\textwidth}p{0.5\textwidth}}
      \toprule
      Name        & Type                       & Description                                        \\
      \midrule
      DateRange   & \begin{tabular}[t]{l}
        datetime array                  \\
        string array                    \\
        cell array of character vectors \\
      \end{tabular} & Range of time.                                     \\
                  &                            & \begin{tabular}[t]{l @{ -- } l}
        Default & \verb!{'2017-01-01','2020-07-15'}!. \\
        Example & \verb!{'2017-01-01','2020-07-15'}!  \\
                & \verb!["2020-02-01","2020-04-30"]!  \\
      \end{tabular}                         \\
      \midrule
      Quantile   & \begin{tabular}[t]{l}
        numeric vector                  \\
      \end{tabular} & Cumulative probabilities. \tnote{\dag}  \\
                  &                            & \begin{tabular}[t]{l @{ -- } l}
        Default & \verb![0.05, 0.25, 0.5, 0.75, 0.95]!. \\
      \end{tabular}                         \\
      \midrule
      Color & \begin{tabular}[t]{l}
        RGB triplet \\
        hexadecimal color code \dots  \\
      \end{tabular} & Color theme of the plot.        \\
                  &                            & \begin{tabular}[t]{l @{ -- } l}
        Default & \verb!'#0072BD'!. \\
      \end{tabular}                         \\
      \midrule
      Alpha & \begin{tabular}[t]{l}
        numeric vector            \\
      \end{tabular} & Face transparency of the objects.        \\
                  &                            & \begin{tabular}[t]{l @{ -- } l}
        Default & \verb![0.1, 0.25]!. \\
      \end{tabular}                         \\
      \midrule
      LineWidth & \begin{tabular}[t]{l}
        positive value            \\
      \end{tabular} & Width of the central line (if exists).       \\
                  &                            & \begin{tabular}[t]{l @{ -- } l}
        Default & \verb!2.5!. \\
      \end{tabular}                         \\
      \midrule
      Others      &      & Modifications of the area objects. \tnote{\ddag}    \\
      \bottomrule
    \end{tabular}
    \begin{tablenotes}
      \scriptsize
      \item [\dag]  {See also \verb!quantile!.}
      \item [\ddag] {See also \verb!Area Properties!.}
    \end{tablenotes}
  \end{threeparttable}
\end{table}





\subsection{Price Distribution}

In this section, we provide two typical tools to display the electricity price in U.S.  After the COVID-19 outbreak, electricity price become harder to trace. In order to trace the change of electricity price, we may observe the price data of different markets in U.S. and organize them into plots. This may offer a new approach for researchers to find out the structure change of U.S. power grid brought by COVID-19.

In \covemda{}, two typical tools regarding different scales are provided for price analysis: \verb!plot_price! and \verb!plotprice_distribution!. Both of them obtain relevant data from file \\\verb!<market_name>_rto_lmp.csv! in the data hub.

\subsubsection{plot price}

This function plots the price curve of a market within specified date range. Like \verb!plot!, it returns the line objects of the curve for further modification.

\begin{Code}
  p = plot_price(market,Name,Value)
\end{Code}

This function is based on \matlab{} function \verb!plot!.

By default, the function plots the price of the specified market from 2017-01-01 to 2020-07-15, with no resampling.Additional optional input arguments can be used to set date range, resampling options and resampling methods. Under this circumstance, the arguments should be in the form of name-value pairs. Valid parameter names are listed in Table~\ref{tab:plot_price_option}. See the help for \verb!plot_price! for details.

\begin{table}[!ht]
\centering
\begin{threeparttable}
\caption{Plot Price Option}
\label{tab:plot_price_option}
\footnotesize
\begin{tabular}{lp{.3\textwidth}p{0.5\textwidth}}
\toprule
Name & Type & Description \\
\midrule
DateRange & \begin{tabular}[t]{l}
datetime array\\
string array\\
cell array of character vectors\\
\end{tabular} & Range of time. \\
& & \begin{tabular}[t]{l @{ -- } l}
Default & \verb!{'2017-01-01','2020-07-15'}!.\\
Example & \verb!{'2017-01-01','2020-07-15'}!\\
& \verb!["2020-02-01","2020-04-30"]!\\
\end{tabular}\\
\midrule
ResampleBin & \begin{tabular}[t]{l}
string\\
character vectors\\
\end{tabular} & Binning scheme for resampling. \tnote{\dag}\\
& & \begin{tabular}[t]{l @{ -- } l}
Default & \verb!'none'!.\\
\end{tabular}\\
\midrule
      ResampleMethod & \begin{tabular}[t]{l}
        string            \\
        character vectors \\
      \end{tabular} & Computation method for resampling. \tnote{\dag}        \\
                  &                            & \begin{tabular}[t]{l @{ -- } l}
        Default & \verb!'mean'!. \\
      \end{tabular}                         \\
      \midrule
Others & & Modifications of the line objects.\tnote{\ddag}\\
\bottomrule
\end{tabular}
\begin{tablenotes}
    \scriptsize
    \item [\dag] {See also \verb!groupsummary!.}
    \item [\ddag] {See also \verb!Plot Properties!.}
\end{tablenotes}
\end{threeparttable}
\end{table}

\subsubsection{plot price distribution}

This function plots the price distribution of a market. 

\begin{Code}
  ar = plot_price_distribution(market, Name, Value);
\end{Code}

This function is based on \matlab{} function \verb!plot!.

By default, the function plots the price distribution of the specified market from 2017-01-01 to 2020-07-15. For instance, use the default settings:

\begin{Code}
  >> plot_price_distribution('isone');
\end{Code}

\begin{figure}
  \centering
  \noindent\includegraphics[width=0.8\textwidth]{figures/visualization_example1.jpg}
  \caption{Price Distribution of ISONE} \label{fig:vis_1}
\end{figure}

And the result is displayed in Figure~\ref{fig:vis_1}. 

Additional optional input arguments can be used to set date range and other options. Under this circumstance, the arguments should be in the form of name-value pairs. Valid parameter names are listed in Table~\ref{tab:plot_price_distribution_opt}. See the help for \verb!plot_price_distribution! for details.
\clearpage
\begin{table}[!ht]
  \centering
  \begin{threeparttable}
    \caption{Plot Price Distribution Options}
    \label{tab:plot_price_distribution_opt}
    \footnotesize
    \begin{tabular}{lp{.3\textwidth}p{0.5\textwidth}}
      \toprule
      Name        & Type                       & Description                                        \\
      \midrule
      DateRange   & \begin{tabular}[t]{l}
        datetime array                  \\
        string array                    \\
        cell array of character vectors \\
      \end{tabular} & Range of time.                                     \\
                  &                            & \begin{tabular}[t]{l @{ -- } l}
        Default & \verb!{'2017-01-01','2020-07-15'}!. \\
        Example & \verb!{'2017-01-01','2020-07-15'}!  \\
                & \verb!["2020-02-01","2020-04-30"]!  \\
      \end{tabular}                         \\
      \midrule
      Others      &      & Modifications of the histogram objects. \tnote{\dag}    \\
      \bottomrule
    \end{tabular}
    \begin{tablenotes}
      \scriptsize
      \item [\dag] {See also \verb!Histogram Properties!.}
    \end{tablenotes}
  \end{threeparttable}
\end{table}

\subsection{Mobility}

Mobility is a factor directly related with the pandemic. Here 'mobility' means the number of visits to business premises, indicating the level of commercial activities. During COVID-19, the mobility in various sectors have experienced dramatic reduction, which is one of the first signals of the outbreak.

In \covemda{}, the mobility data for three sectors are provided: \verb!Restaurant_Recreation!, \verb!Grocery_Pharmacy! and \verb!Retail!. Unlike other functions in this section, here the data are focused on \textbf{seven major cities}: Los Angeles(\verb!la!), Houston(\verb!houston!), Boston(\verb!boston!), New York City(\verb!nyc!), Chicago(\verb!chicago!), Philadelphia(\verb!phila!) and Kansas City(\verb!kck!). All the data above are obtained from file \verb!<market_name>_<city_name>_patterns.csv! and can be visualized by function \verb!plot_mobility!.

\subsubsection{plot mobility}

This function plots the appointed mobility curve of one of the seven cities. Like \verb!plot!, it returns the line object of the curve for further modification.

\begin{Code}
  p = plot_mobility(city, varargin);
\end{Code}

This function is based on \matlab{} function \verb!plot!.

By default, the function plots the mobility data of the retail sector in the specified city from 2019-12-30 to 2020-11-22, with no resampling. Additional optional input arguments can be used to set sector, date range and resampling options. Under this circumstance, the arguments should be in the form of name-value pairs. Valid parameter names are listed in Table~\ref{tab:plot_mob_opt}. See the help for \verb!plot_mobility! for details.

\begin{table}[!ht]
  \centering
  \begin{threeparttable}
    \caption{Plot Mobility Options}
    \label{tab:plot_mob_opt}
    \footnotesize
    \begin{tabular}{lp{.3\textwidth}p{0.5\textwidth}}
      \toprule
      Name        & Type                       & Description                                        \\
      \midrule
      DateRange   & \begin{tabular}[t]{l}
        datetime array                  \\
        string array                    \\
        cell array of character vectors \\
      \end{tabular} & Range of time.                                     \\
                  &                            & \begin{tabular}[t]{l @{ -- } l}
        Default & \verb!{'2017-01-01','2020-07-15'}!. \\
        Example & \verb!{'2017-01-01','2020-07-15'}!  \\
                & \verb!["2020-02-01","2020-04-30"]!  \\
      \end{tabular}                         \\
      \midrule
      Sector & \begin{tabular}[t]{l}
        string            \\
        character vectors \\
      \end{tabular} & The sector to be plotted.        \\
                  &                            & \begin{tabular}[t]{l @{ -- } l}
        Default & \verb!'Retail'!. \\
        Example & \verb!'Retail'!. \\
                & \verb!'Restaurant_Recreaction'! \\
                & \verb!'Grocery_Pharmacy'!       \\
      \end{tabular}                         \\
      \midrule
      ResampleBin & \begin{tabular}[t]{l}
        string            \\
        character vectors \\
      \end{tabular} & Binning scheme for resampling. \tnote{\dag}        \\
                  &                            & \begin{tabular}[t]{l @{ -- } l}
        Default & \verb!'none'!. \\
      \end{tabular}                         \\
      \midrule
      ResampleMethod & \begin{tabular}[t]{l}
        string            \\
        character vectors \\
      \end{tabular} & Computation method for resampling. \tnote{\dag}        \\
                  &                            & \begin{tabular}[t]{l @{ -- } l}
        Default & \verb!'mean'!. \\
      \end{tabular}                         \\
      \midrule
      Others      &                            & Modifications of the line object.\tnote{\ddag}    \\
      \bottomrule
    \end{tabular}
    \begin{tablenotes}
      \scriptsize
      \item [\dag]  {See also \verb!groupsummary!.}
      \item [\ddag] {See also \verb!Line Properties!.}
    \end{tablenotes}
  \end{threeparttable}
\end{table}





\subsection{Examples}

\subsubsection{Basic Usage} \label{subsubsec:vis_basic}

All functions mentioned above have similar input-output forms and can be used similarly. To be specific, the first input argument (market name or city name) is complimentary, and all the other input arguments are optional. The market name is specified as one of the seven terms:

\begin{center}
  \verb!'caiso' | 'ercot' | 'isone' | 'miso' | 'nyiso' | 'pjm' | 'spp'!
\end{center}

And the city name is specified as one of the seven abbreviations:

\begin{center}
  \verb!'la' | 'houston' | 'boston' | 'nyc' | 'chicago' | 'phila' | 'kck'!
\end{center}

For \verb!plot_mobility! where the city name needs to be specified, the corresponding market name is not necessary. The function automatically recognizes the market which the city is in, as long as it is one of the seven cities listed above.

All the other input arguments should be in the form of \textbf{name-value pairs} for the function to correctly recognize.

\begin{Code}
  plot_demand(market, 'argument_name1', argument_value1,
  'argument_name2', argument_value2, ...);
\end{Code}

Valid parameter names for each function above are listed in Table~\ref{tab:plot_gene_mix_option} to~\ref{tab:plot_mob_opt}. Pay attention that \verb!plot_demand!, \verb!plot_renewable_share!, \verb!plot_price! and \verb!plot_mobility! are based on \matlab{} function \verb!plot!, \verb!plot_generation_mix! is based on \verb!area! and \verb!plot_price_distribution! based on \verb!histogram!. For those functions, all the name-value pair arguments are passed to corresponding \matlab{} functions except the ones listed in the table. For \verb!plot_daily_demand_curve!, however, the arguments are mainly passed to \verb!area!. If there are odd quantiles, the central one is displayed with \verb!plot! and only \verb!'Color'! and \verb!'LineWidth'! are passed to it.

The output argument is the graphics object(s) of the plot, just like \verb!plot!, \verb!area! and \verb!histogram!. The number of the object depends on the function type. For \verb!plot_renewable_share!, \verb!plot_demand!, \verb!plot_price! and \verb!plot_mobility!, the function returns only one line object. For \verb!plot_generation_mix!, the number of area objects returned is equal to the number of fuel types. For \verb!plot_price_distribution!, the function returns only one histogram object. For \verb!plot_daily_demand_curve!, the function returns all the area objects and the line object (if exists) of the plot. It can be utilized to modify the plot after calling the function, as is illustrated in~\ref{subsubsec:vis_cus}.

As long as the market name (or the city name) is given, a basic version of the desired plot can be simply obtained. For example, to plot the price distribution histogram of ISONE, just enter

\begin{Code}
  >> plot_price_distribution('isone');
\end{Code}

\begin{figure}
  \centering
  \noindent\includegraphics[width=0.8\textwidth]{figures/visualization_example1.jpg}
  \caption{Example: Price Distribution of ISONE} \label{fig:vis_eg1}
\end{figure}

The result is displayed in Figure~\ref{fig:vis_eg1}. By default, the price distribution histogram of ISONE from 2017-01-01 to 2020-07-15 is plotted. If the user wants to change the date range, parameter \verb!DateRange! should be specified. For example, to plot the renewable share curve of NYISO from February to April in 2020, the user may enter

\begin{Code}
  >> plot_renewable_share('nyiso', 'DateRange', {'2020-02-01',
      '2020-04-30'});
\end{Code}

\begin{figure}
  \centering
  \noindent\includegraphics[width=0.8\textwidth]{figures/visualization_example2.jpg}
  \caption{Example: Renewable Share of NYISO} \label{fig:vis_eg2}
\end{figure}

The result is displayed in Figure~\ref{fig:vis_eg2}, where the desired renewable share curve is plotted.

Some of the functions provide an option for resampling data, making them more flexible to use. For example, to plot the average price of every month in 2019, the user may enter

\begin{Code}
  >> plot_price('nyiso', 'DateRange', {'2019-01-01', '2019-12-31'},
  'ResampleBin', 'month', 'ResampleMethod', 'mean');
\end{Code}

\begin{figure}
  \centering
  \noindent\includegraphics[width=0.8\textwidth]{figures/visualization_example3.jpg}
  \caption{Example: Average Price of NYISO} \label{fig:vis_eg3}
\end{figure}

The result is displayed in Figure~\ref{fig:vis_eg3}, where the desired price trend is plotted.

Like \verb!plot!, all the functions can be used more than once to plot multiple curves in one figure. For example, to plot the demand curves of NYISO in 2018, 2019 and 2020 with week alignment, first calculate the corresponding date range:

\begin{Code}
  >> dr_2020 = datetime('2020-2-1'):datetime('2020-4-30');
  >> dr_2019 = cal_baseline(dr_2020, 'Method', 'week');
  >> dr_2018 = cal_baseline(dr_2020, 'Method', 'week',
  'YearDuration', 2);
  >> dr_2017 = cal_baseline(dr_2020, 'Method', 'week',
  'YearDuration', 3);
\end{Code}

Thus the desired date ranges for 2018, 2019 and 2020 are \verb!dr_2018!, \verb!dr_2019! and \verb!dr_2020! correspondingly. Now plot the demand curves:

\begin{Code}
  >> plot_demand('nyiso', 'DateRange', dr_2018, 'DisplayName',
  '2018', 'LineStyle', ':', 'Color', '#939598');
  >> plot_demand('nyiso', 'DateRange', dr_2019, 'DisplayName',
  '2019', 'LineStyle', '--', 'Color', '#D95319');
  >> plot_demand('nyiso', 'DateRange', dr_2020, 'DisplayName',
  '2020', 'Color', '#0072BD', 'LineWidth', 2.5);
\end{Code}

\begin{figure}
  \centering
  \noindent\includegraphics[width=0.8\textwidth]{figures/visualization_example4.jpg}
  \caption{Example: Demand Curves of NYISO} \label{fig:vis_eg4}
\end{figure}

The result is displayed in Figure~\ref{fig:vis_eg4}, where the desired demand curves are plotted. In the example above, several properties of the lines are customized for better recognition. In~\ref{subsubsec:vis_cus}, the modification of plots is explored further.



\subsubsection{Customize Plot Properties} \label{subsubsec:vis_cus}

Like \matlab{}, there are mainly two approaches in \covemda{} to modifying a plot: before and after calling the plotting function. The former way refers to passing arguments in the form of \textbf{name-value pairs}, and the latter one refers to changing \textbf{property values} of the chart. They each have their own strengths, and both of them are commonly used to beautify a plot.

In the last example in~\ref{subsubsec:vis_basic}, several properties (label, color and line width) of the three lines are modified by passing name-value pair arguments to the function. In this way, the user is able to integrate multiple modifications in one line of code, making it concise and simple. For example, to display markers at data points, the user may enter

\begin{Code}
  >> plot_price('nyiso', 'ResampleBin', 'month', 'Marker', 'o');
\end{Code}

\begin{figure}
  \centering
  \noindent\includegraphics[width=0.8\textwidth]{figures/visualization_example5.jpg}
  \caption{Example: Average Price of NYISO (with Markers)} \label{fig:vis_eg5}
\end{figure}

The result is displayed in Figure~\ref{fig:vis_eg5}, where all the data points are marked with a symbol 'o'. Any other marker symbol can be used in the same way, as long as it is recognized by \verb!plot!.

However, it is difficult to obtain detailed control of the plot by merely passing arguments to the functions, which is why sometimes we also need to change property values after plotting the figure. For example, to change the default display range of y-axis, the user may enter

\begin{Code}
  >> plot_daily_demand_curve('nyiso');
  >> ax = gca;
  >> ax.YLim = [0, 4];
\end{Code}

\begin{figure}
  \centering
  \noindent\includegraphics[width=0.8\textwidth]{figures/visualization_example6_1.jpg}
  \caption{Example: Daily Demand Curve of NYISO (Before Changing range of y-axis)} \label{fig:vis_eg6_1}
\end{figure}

\begin{figure}
  \centering
  \noindent\includegraphics[width=0.8\textwidth]{figures/visualization_example6_2.jpg}
  \caption{Example: Daily Demand Curve of NYISO (After Changing range of y-axis)} \label{fig:vis_eg6_2}
\end{figure}

The result is displayed in Figure~\ref{fig:vis_eg6_1} and~\ref{fig:vis_eg6_2}, where the range of y-axis is enlarged. As the modified property belongs to the axes of the figure rather than area or line objects, the command \verb!ax = gca! is utilized to access the axes. Also, \verb!ylim([0, 4])! (using the function \verb!ylim!) has the same effect as \verb!ax.YLim = [0, 4]! in this case.

Under some circumstances, there may exist more than one object in the graph, which is common when using functions concerning \verb!area!. For example, to highlight renewable energy in a generation mix graph, the user may enter

\begin{Code}
  >> ar = plot_generation_mix('spp');
  >> ar(1).FaceColor = '#868686';
  >> ar(2).FaceColor = '#acacac';
  >> ar(4).FaceColor = '#7f7f7f';
  >> ar(5).FaceColor = '#6b6b6b';
\end{Code}

\begin{figure}
  \centering
  \noindent\includegraphics[width=0.8\textwidth]{figures/visualization_example7_1.jpg}
  \caption{Example: Generation Mix of SPP (Before Highlighting Renewables)} \label{fig:vis_eg7_1}
\end{figure}

\begin{figure}
  \centering
  \noindent\includegraphics[width=0.8\textwidth]{figures/visualization_example7_2.jpg}
  \caption{Example: Generation Mix of SPP (After Highlighting Renewables)} \label{fig:vis_eg7_2}
\end{figure}

The result is displayed in Figure~\ref{fig:vis_eg7_1} and~\ref{fig:vis_eg7_2}, where the color of all fuel types except hydro, solar and wind are changed to gray after the graph is plotted. Therefore, the renewables are visually highlighted.

Such modifications are obtained by changing property values of certain objects using dot notation. For a list of properties, see \verb!Axes Properties!, \verb!Line Properties!, \verb!Area Properties! and \verb!Histogram Properties!. See the help for each function for details.





%--------------------------------
\newpage
\section{Baseline Estimation} \label{sec:baseline}

Baseline refers to the basis of comparison with or without certain factor. Here, baseline estimation provides the control group for analysis of the impact of COVID-19 on electricity consumption. Traditional method for baseline estimation usually involves selecting specific days of the same patterns in the past, and integrating corresponding historical data. Such methods rely heavily on the principle for similar date selection, reducing their robustness and accuracy. By contrast, \textbf{ensemble backcast model} utilizes deep neural networks and multi-dimensional historical data to produce a more reliable baseline. In practice, as the default algorithm for baseline estimation in \covemda{}, it accurately reflects the normal trend of electricity consumption in the absence of the pandemic.

\covemda{} function \verb!cal_baseline! provides a uniform tool for baseline calculation by either date alignment, week index alignment or backcast estimation. By default, the function calculates the load baseline of specified ISO or city (if \verb!City! is specified) by backcast estimation from 2020-02-01 to 2020-06-30. The user needs to specify the value of name-value pair argument Method to alter calculation method (\verb!'date', 'week', 'backcast'!), or DateRangeCovid to change the output date range.

In addition, \covemda{} offers a tool for simple visualization of different baseline estimation methods: \verb!plot_baseline!. This function calculates the load baseline with different estimation methods by \verb!cal_baseline!, and plots them in one graph. The user can appoint the methods to be plotted by specifying the value of name-value pair argument Method. Unlike \verb!cal_baseline!, here the parameter value can be multiple method names in the form of cell arrays or string arrays, etc. The user can specify the bin and method for resampling data of the plot by argument \verb!ResampleBin, ResampleMethod! as well, just like the visualization functions in Sec.~\ref{sec:visual}.

In practical use, all the other arguments to be mentioned below are actually passed by the two high-level functions above. For instance, to train the ensemble backcast model with specified model numbers before estimating baseline, the user may call the function \verb!cal_baseline! like this:

\begin{Code}
>> cal_baseline('nyiso', 'TrainModel', 1, 'ModelNum', [10, 3]);
\end{Code}

\subsection{Date and Week Alignment}



If \verb!Method! is specified as \verb!date!, function \verb!cal_baseline! calculates the load baseline by searching for the load data of the exact same date and month in the previous year, for every day in \verb!DateRangeCovid!. This calculation process is performed by \covemda{} low-level function \verb!cal_baseline_by_dates!.

If \verb!Method! is specified as \verb!week!, function \verb!cal_baseline! calculates the load baseline by searching for the load data of the exact same week and day of week in the previous year, for every day in \verb!DateRangeCovid!. This calculation process is performed by \covemda{} low-level function \verb!cal_baseline_by_week_index!.

If either of those two situations occurs, no extra name-value pairs need to be specified.



\subsection{Ensemble Backcast Estimation}
The \textbf{Ensemble Backcast Model} is used to estimate the electricity consumption profile in the absence of COVID-19 pandemic, so that the comparison between the model and actual metered electricity consumption can be used to quantify the impact of COVID-19.

A backcast model is expressed as a function that maps potential factors that may affect electricity consumption level, including weather variables (such as temperature, humidity and wind speed), date of year, and economic prosperity (yearly GDP growth rate) to the estimated electricity consumption. Given a group of backcast models, ensemble forecasting is widely recognized as the best approach to provide rich interval information. A group of backcast models for the daily average electricity consumption can be described by

\begin{equation*}
  \hat L_{md}=\frac{1}{N}\sum\limits_{i=1}^N \hat f_i(C_{md}, T_{mdq}, H_{mdq}, S_{mdq}, E),\forall m,d
\end{equation*}

where 
\begin{itemize}
  \item $C_{md}$ is the calendar information including month, day, weekday, and holiday flag.
  \item $\hat L_{md}$ is the estimated daily average electricity consumption for month $m$ and day $d$.
  \item $\hat f_i$ is the $i$-th backcast model.
  \item $T_{mdq},H_{mdq},S_{mdq}$ are temperature, humidity and wind speed within the selected quantiles $q$.
  \item $E$ is the estimated GDP growth rate.
\end{itemize}
We typically include 25\%, 50\% (average value), 75\% and 100\%(maximium) quantiles, and the final inputs should be decided based on the the data after extensive testing. With the backcast estimations, the daily reduction in electricity consumption $r_{md}$ is calculated as follows,
\begin{equation}
  \label{eqn:ensemble}
  r_{md}=(1-\frac{1}{\hat L_{md}}\cdot \frac{1}{T}\sum\limits_{t=1}^TL_{mdt})\times 100\%, \forall m,d,
\end{equation}
where $T=24$ is the total number of hours in one day, and $L_{mdt}$ is the electricity consumption metered at time $t$ on month $m$ and day $d$. Equation~\ref{eqn:ensemble} compares the ensemble backcast and actual electricity consumption results, and can be readily extended to interval estimations by adjusting the ensemble backcast result.


If \verb!Method! is specified as \verb!backcast!, function \verb!cal_baseline! calculates the load baseline by either training new models or using existing models. This calculation process is performed by \covemda{} low-level function \verb!cal_baseline_by_backcast!, and other complementary functions. Valid parameter names are listed in Table~\ref{tab:back_opt}.

Function \verb!cal_baseline_by_backcast! consists of 3 or 6 steps (depends on whether to train models or not). To be more specific, if the user chooses to train a new model, the function

\begin{enumerate}
    \item imports training data and splits training and testing set (\verb!backcast_import_data!);
    \item trains two-layer deep neural network models using training set with validation (\verb!backcast_scan_training!);
    \item tests all the models and selects the best ones using testing set (\verb!backcast_test_model!);
    \item saves trained models and summary (\verb!basic_backcast_save_file!);
    \item imports data for baseline estimation (\verb!backcast_import_data!);
    \item calculates the load baseline with quantiles (\verb!backcast_scan_prediction!).
\end{enumerate}

If the user chooses not to train models but to use pre-trained models, the function

\begin{enumerate}
    \item imports existing models (\verb!basic_backcast_import_models!);
    \item imports data for baseline estimation (\verb!backcast_import_data!);
    \item calculates the load baseline with quantiles (\verb!backcast_scan_prediction!).
\end{enumerate}

\begin{table}[!ht]
  \centering
  \begin{threeparttable}
    \caption{Calculate Baseline By Backcast Options}
    \label{tab:back_opt}
    \footnotesize
    \begin{tabular}{lp{.3\textwidth}p{0.5\textwidth}}
      \toprule
      Name & Type & Description \\
      \midrule
      TrainModel & integer value & Train (1) or not train (0) models.   \\
       & & \begin{tabular}[t]{l @{ -- } l}
        Default & 0. \\
      \end{tabular}                         \\
      \midrule
      ImportNum & integer value or \verb!'latest'! & The id of the existing model to be imported. Only effective when TrainModel=0.  \\
       & & \begin{tabular}[t]{l @{ -- } l}
        Default & \verb!'latest'!. \\
      \end{tabular}                         \\
      \midrule
      DateRangeTrain & \begin{tabular}[t]{l}
        datetime array \\
        string array    \\
        cell array of character vectors \\
      \end{tabular} & Range of time for model training. Only effective when TrainModel=1.  \\
       & & \begin{tabular}[t]{l @{ -- } l}
        Default & \verb!{'2018-02-01','2020-01-31'}!. \\
        Example & \verb!{'2018-01-01','2019-12-31'}!  \\
                & \verb!["2018-01-01","2019-12-31"]!  \\
      \end{tabular} \\
      \midrule
      ModelNum & two-element numeric vector & The number of models to be tested and selected. Only effective when TrainModel=0.  \\
       & & \begin{tabular}[t]{l @{ -- } l}
        Default & \verb![800, 200]!. \\
      \end{tabular}                         \\
      \midrule
      numHiddenUnits & two-element numeric vector & The number of hidden units in the two full connection layers. Only effective when TrainModel=0.  \\
       & & \begin{tabular}[t]{l @{ -- } l}
        Default & \verb![32, 64]!. \\
      \end{tabular}                         \\
      \midrule
      TrainVerbose & integer value & Indicator to display training progress information. No display(0), brief display(1) or detailed display(2). Only effective when TrainModel=0.  \\
       & & \begin{tabular}[t]{l @{ -- } l}
        Default & 1. \\
      \end{tabular}                         \\
      \midrule
      RandVariation & double value in (0,1) & Relative range (1-RandVariation, 1+RandVariation) of random variation of model parameters numHiddenUnits for scan training. Only effective when TrainModel=0.  \\
       & & \begin{tabular}[t]{l @{ -- } l}
        Default & 0.2. \\
      \end{tabular}                         \\
      \midrule
      SaveModel & integer value & Indicator to save trained models in \matlab{} .asv files. Save(1) or not save(0). Only effective when TrainModel=0.  \\
       & & \begin{tabular}[t]{l @{ -- } l}
        Default & 1. \\
      \end{tabular}                         \\
      \midrule
      SaveModelONNX & integer value & Indicator to save trained models in .onnx files. Save(1) or not save(0). Only effective when TrainModel=0.  \\
       & & \begin{tabular}[t]{l @{ -- } l}
        Default & 0. \\
      \end{tabular}                         \\
      \midrule
      SaveSummary & integer value & Indicator to save summary of trained models. Save(1) or not save(0). Only effective when TrainModel=0.  \\
       & & \begin{tabular}[t]{l @{ -- } l}
        Default & 1. \\
      \end{tabular}                         \\
      \midrule
      Quantile & numeric vector in (0,1) & Quantiles to be calculated in scan prediction. \\
       & & \begin{tabular}[t]{l @{ -- } l}
        Default & \verb![0.1, 0.25, 0.5, 0.75, 0.9]!. \\
        Example & 0.5   \\
      \end{tabular}                         \\
      \midrule
      PredictVerbose & integer value & Indicator to display prediction progress information. No display(0) or brief display(1).  \\
       & & \begin{tabular}[t]{l @{ -- } l}
        Default & 1. \\
      \end{tabular}                         \\
      \bottomrule
    \end{tabular}
  \end{threeparttable}
\end{table}


\subsection{Abnormal Price Index}

Locational marginal prices play a crucial role in electricity markets and contribute to balancing generation and demand efficiently. Since these prices are relatively stochastic in nature, it is unsatisfactory to analyze them in the same way as electricity demand\footnote{the uncertainty intervals will be very wide}. Thus, the abnormal price index is developed to provide a more reliable tool for price analysis, which is defined as follows,
\begin{equation*}
  I(\lambda_{ymdt})=|2\hat F_m(\lambda_{ymdt})-1|, \forall y,m,d,t,
\end{equation*}
where $\lambda_{ymdt}$ is the day-ahead locational marginal price of year $y$, month $m$, day $d$, and hour $t$. $I(\cdot)$ is the proposed index, which lies between zero and one. This index quantifies the abnormality of a typical price, and a larger index value represents a more unusual observation. $\hat F_m(\cdot)$ is the cumulative distribution function for the prices in month $m$.\footnote{Which are more stable for analyzing these price changes. See the reason in \cite{quantitaveassess}}.

The statistical meaning of the above index is explained by the probability density function shown in Figure~\ref{fig:abnormal_price_index}. For a given price, the index donates a possibility that measures how close this price is to the mean value. For example, if a price observation is located within the 25\% and 75\% quantiles, we obtain an index value below 0.5, which is considered normal.
\begin{figure}
  \centering
  \includegraphics[width=.8\textwidth]{figures/abnormal_price_index.png}
  \caption{Statistical illustration of the proposed abnormal price index. The basic idea is to show how near a price observation is to the mean value. This index can eliminate some stochastic factors when assessing price changes. The index value lies in [0,1], and a larger value means a higher possibility of abnormality.}
  \label{fig:abnormal_price_index}
\end{figure}

\begin{Code}
output = cal_abnormal_price_index(market, varargin)
\end{Code}
\subsection{Excess Change Rate of Renewable}





%---------------------------------
\newpage
\section{Regression Analysis} \label{sec:regression}

\subsection{Regression Methodology}
To interpret the changes in electricity consumption during pandemic, three potential factors, namely, public health, social distancing, and the level of commercial activities, should be taken into account. 

Restried Vector Autoregression (Restricted VAR) models are implemented in \covemda. Restricted VAR models are powerful tools for multivariate time series analysis with complex correlations.

Vector autoregression (VAR)\cite{var} is a stochastic process model that can be used to capture the linear correlation between multiple time-series. We model the dynamics of reduction in electricity consumption using a Restricted VAR model of order p as follows:

\begin{equation}
  X_t=C+A_1X_{t-1}+\dots+A_pX_{t-p}+E_t,
\end{equation}
where
\begin{equation}
  A_i=
  \begin{bmatrix}
  a_{1,1}^i & a_{1,2}^i & \cdots & a_{1,n}^i\\
  a_{2,1}^i & a_{2,2}^i & \cdots & a_{2,n}^i\\
  \vdots & \vdots & \ddots & \vdots \\
  a_{n,1}^i & a_{n,2}^i & \cdots & a_{n,n}^i\\
  \end{bmatrix}
  ,X_t=
  \begin{bmatrix}
    x_t^1\\x_t^2\\\vdots\\x_t^n
  \end{bmatrix},
  C=
  \begin{bmatrix}
    c^1\\c^2\\\vdots\\c^n
  \end{bmatrix},
  E_t=
  \begin{bmatrix}
    e_t^1\\e_t^2\\\vdots\\e_t^n
  \end{bmatrix},
\end{equation}
in which $A_i$ is the regression matrix, $x_t^1$ represents the target output variable at time $t$, namely the reduction in electricity consumption we wish to model, $x_t^2,\cdots,x_t^n$ represent the selected $n-1$ parameter variables including confirmed case numbers, stay-at-home population, median home dwell time rate, population of on-site workers, mobility in the retail sector and etc., $C$ and $E_t$ are respectively column vectors of intercept and random errors, and the time notation $t-p$ represents the $p$-th lag of the variables.

\subsection{Factor Analysis}
The full procedure of building the restricted VAR model mainly contains four steps as follows, including pre-estimation preparation, restricted VAR model estimation, restricted VAR model verification, and post-estimation analysis.
\subsubsection{Pre-estimation Preparation}
\begin{itemize}
  \item Data Preprocessing: Several datasets are collected to calculate the inputs of restricted VAR model, including electricity market data, weather data, number of COVID-19 cases, and mobile device location data. We take logarithms of several variables, including electricity consumption reduction, new daily confirmed cases, stay-at-home population, population of full-time on-site workers, population of part-time on-site workers, and mobility in the retail sector, while only keeping the original value of the median home dwell time rate.
  \item Augmented Dickey-Fuller (ADF) Test: Test whether a time-series variable is non-stationary and possesses a unit root.
  \item Cointegration Test: Test the long-term correlation between multiple non-stationary time-series.
  \item Granger Causality Wald Test: Estimate the causality relationship among two variables represented as time-series.
\end{itemize}
\subsubsection{Restricted VAR Model Estimation}
\begin{itemize}
  \item  Ordinary Least Square (OLS): We impose constraints on the OLS to eliminate any undesirable causal relationships between variables.
\end{itemize}
\subsubsection{Restricted VAR Model Verification}
\begin{itemize}
  \item ADF Test: Verify if the residual time-series are non-stationary and possess a unit root.
  \item Ljung-Box Test: Verify the endogeneity of the residual data that may render the regression result untrustworthy.
  \item Durbin-Watson Test: Detect the presence of autocorrelation at log 1 in the residuals of the Restricted VAR model.
  \item Robustness Test: Test the robustness of the Restricted VAR model against parameter perturbations.
\end{itemize}
\subsubsection{Post-estimation Analysis}
\begin{itemize}
  \item Impulse Response Analysis: Describe the evolution of the Restricted VAR models variable in response to a shock in one or more variables.
  \item Forecast Error Variance Decomposition: Aid in the interpretation of the Restricted VAR model by determining the proportion of each variables forecast variance that is contributed by shocks to the other variables.
\end{itemize}




%------------------------------------------------
\newpage
\section{Acknowledgments} \label{sec:thanks}






%------------------------------------------------
\begin{appendices}

\newpage
\section{Glossary} \label{sec:}


\end{appendices}




\newpage
\section*{Reference} \label{sec:ref}
\addcontentsline{toc}{section}{Reference}

\end{document}
